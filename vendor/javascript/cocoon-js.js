// cocoon-js@0.0.5 downloaded from https://ga.jspm.io/npm:cocoon-js@0.0.5/index.js

import e from"jquery";var n="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var t={};var o=function(e){var t=0;var create_new_id=function(){return(new Date).getTime()+t++};var newcontent_braced=function(e){return"["+e+"]$1"};var newcontent_underscord=function(e){return"_"+e+"_$1"};var getInsertionNodeElem=function(n,t,o){if(!n)return o.parent();if("function"==typeof n){t&&console.warn("association-insertion-traversal is ignored, because association-insertion-node is given as a function.");return n(o)}return"string"==typeof n?t?o[t](n):"this"==n?o:e(n):void 0};e(document).on("click",".add_fields",(function(t){t.preventDefault();var o=e(this||n),a=o.data("association"),i=o.data("associations"),r=o.data("association-insertion-template"),s=o.data("association-insertion-method")||o.data("association-insertion-position")||"before",c=o.data("association-insertion-node"),d=o.data("association-insertion-traversal"),l=parseInt(o.data("count"),10),f=new RegExp("\\[new_"+a+"\\](.*?\\s)","g"),u=new RegExp("_new_"+a+"_(\\w*)","g"),v=create_new_id(),p=r.replace(f,newcontent_braced(v)),g=[];if(p==r){f=new RegExp("\\[new_"+i+"\\](.*?\\s)","g");u=new RegExp("_new_"+i+"_(\\w*)","g");p=r.replace(f,newcontent_braced(v))}p=p.replace(u,newcontent_underscord(v));g=[p];l=isNaN(l)?1:Math.max(l,1);l-=1;while(l){v=create_new_id();p=r.replace(f,newcontent_braced(v));p=p.replace(u,newcontent_underscord(v));g.push(p);l-=1}var m=getInsertionNodeElem(c,d,o);m&&0!=m.length||console.warn("Couldn't find the element to insert the template. Make sure your `data-association-insertion-*` on `link_to_add_association` is correct.");e.each(g,(function(n,t){var o=e(t);var a=e.Event("cocoon:before-insert");m.trigger(a,[o]);if(!a.isDefaultPrevented()){var i=m[s](o);m.trigger("cocoon:after-insert",[o])}}))}));e(document).on("click",".remove_fields.dynamic, .remove_fields.existing",(function(t){var o=e(this||n),a=o.data("wrapper-class")||"nested-fields",i=o.closest("."+a),r=i.parent();t.preventDefault();var s=e.Event("cocoon:before-remove");r.trigger(s,[i]);if(!s.isDefaultPrevented()){var c=r.data("remove-timeout")||0;setTimeout((function(){if(o.hasClass("dynamic"))i.remove();else{o.prev("input[type=hidden]").val("1");i.hide()}r.trigger("cocoon:after-remove",[i])}),c)}}));e(document).on("ready page:load turbolinks:load",(function(){e(".remove_fields.existing.destroyed").each((function(t,o){var a=e(this||n),i=a.data("wrapper-class")||"nested-fields";a.closest("."+i).hide()}))}))}(e);t={cocoon:o};var a=t;const i=t.cocoon;export default a;export{i as cocoon};

